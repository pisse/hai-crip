if(typeof Zepto==="undefined"){throw new Error("Parallax.js's script requires Zepto")}!function(e){var y,u,t,f,p,g,n,v,j,b,a,c,i,o=false,k=true;e.fn.parallax=function(z){i=e.extend({},e.fn.parallax.defaults,z);return this.each(function(){b=e(this);a=b.find(".page");r()})};e.fn.parallax.defaults={direction:"vertical",swipeAnim:"default",drag:true,progress:false,indicator:false,arrow:false,onchange:function(){},orientationchange:function(){}};function r(){if(i.progress){e(".wrapper").append('<div class="parallax-progress"><i class="ui-progress ui-progress-white"></i></div>')}else{k=false}g=0;p="stay";n=a.length;v=document.documentElement.clientWidth;j=document.documentElement.clientHeight;c=e("[data-animation]");for(var z=0;z<n;z++){e(a[z]).attr("data-id",z+1)}b.addClass(i.direction).addClass(i.swipeAnim);a.css({width:v+"px",height:j+"px"});i.direction==="horizontal"?b.css("width",v*a.length):b.css("height",j*a.length);if(i.swipeAnim==="cover"){b.css({width:v,height:j});a[0].style.display="block"}if(!i.progress){e(a[g]).addClass("current");i.onchange(g,a[g],p);l()}}function q(z){if(k===true){event.preventDefault();return false}o=true;i.direction==="horizontal"?y=z.pageX:y=z.pageY;if(i.swipeAnim==="default"){b.addClass("drag");f=b.css("-webkit-transform").replace("matrix(","").replace(")","").split(",");i.direction==="horizontal"?f=parseInt(f[4]):f=parseInt(f[5])}if((i.swipeAnim==="cover"&&i.drag)){a.addClass("drag")}t=1}function d(z){if(k===true||o===false){event.preventDefault();return false}event.preventDefault();i.direction==="horizontal"?u=z.pageX:u=z.pageY;s();if(i.drag&&!w()){x()}t=2}function h(z){if(k===true||t!==2){}else{o=false;i.direction==="horizontal"?u=z.pageX:u=z.pageY;if(i.swipeAnim==="default"&&!w()){b.removeClass("drag");if(Math.abs(u-y)<=50){m(g);p="stay"}else{if(u>=y){m(g-1);p="backward"}else{if(u<y){m(g+1);p="forward"}}}}else{if(i.swipeAnim==="cover"&&!w()){if(Math.abs(u-y)<=50&&u>=y&&i.drag){m(g,"keep-backward");p="stay"}else{if(Math.abs(u-y)<=50&&u<y&&i.drag){m(g,"keep-forward");p="stay"}else{if(Math.abs(u-y)>50&&u>=y&&i.drag){m(g-1,"backward");p="backward"}else{if(Math.abs(u-y)>50&&u<y&&i.drag){m(g+1,"forward");p="forward"}else{if(Math.abs(u-y)>50&&u>=y&&!i.drag){m(g-1,"backward");p="backward"}else{if(Math.abs(u-y)>50&&u<y&&!i.drag){m(g+1,"forward");p="forward"}}}}}}}}if(i.indicator){e(e(".parallax-h-indicator ul li, .parallax-v-indicator ul li").removeClass("current").get(g)).addClass("current")}t=3}}function x(){if(i.swipeAnim==="default"){var z=f+u-y;i.direction==="horizontal"?b.css("-webkit-transform","matrix(1, 0, 0, 1, "+z+", 0)"):b.css("-webkit-transform","matrix(1, 0, 0, 1, 0, "+z+")")}else{if(i.swipeAnim==="cover"){var z=u-y,A=e(a[g-1]),B=e(a[g+1]);e(a).css({"z-index":0});if(i.direction==="horizontal"&&u>=y){A.css({"z-index":2,display:"block","-webkit-transform":"translateX("+(z-v)+"px)"})}else{if(i.direction==="horizontal"&&u<y){B.css({"z-index":2,display:"block","-webkit-transform":"translateX("+(v+z)+"px)"})}else{if(i.direction==="vertical"&&u>=y){A.css({"z-index":2,display:"block","-webkit-transform":"translateY("+(z-j)+"px)"})}else{if(i.direction==="vertical"&&u<y){B.css({"z-index":2,display:"block","-webkit-transform":"translateY("+(j+z)+"px)"})}}}}}}}function m(A,z){g=A;if(i.swipeAnim==="default"){var B=0;i.direction==="horizontal"?B=A*(-v):B=A*(-j);i.direction==="horizontal"?b.css({"-webkit-transform":"matrix(1, 0, 0, 1, "+B+", 0)"}):b.css({"-webkit-transform":"matrix(1, 0, 0, 1, 0, "+B+")"})}else{if(i.swipeAnim==="cover"){if(z==="keep-backward"&&i.drag){a.removeClass("drag");i.direction==="horizontal"?e(a[g-1]).css({"-webkit-transform":"translateX(-100%)"}):e(a[g-1]).css({"-webkit-transform":"translateY(-100%)"})}else{if(z==="keep-forward"&&i.drag){a.removeClass("drag");i.direction==="horizontal"?e(a[g+1]).css({"-webkit-transform":"translateX(100%)"}):e(a[g+1]).css({"-webkit-transform":"translateY(100%)"})}else{if(z==="forward"&&i.drag){a.removeClass("drag");e(a[g-1]).addClass("back");a[g].style.webkitTransform="translate(0, 0)"}else{if(z==="backward"&&i.drag){a.removeClass("drag");e(a[g+1]).addClass("back");a[g].style.webkitTransform="translate(0, 0)"}else{if(z==="forward"&&!i.drag){b.addClass("animate");e(a[g-1]).addClass("back");e(a[g]).addClass("front").show()}else{if(z==="backward"&&!i.drag){b.addClass("animate");e(a[g+1]).addClass("back");e(a[g]).addClass("front").show()}}}}}}}}k=true;setTimeout(function(){k=false},300)}function s(){if(i.direction==="horizontal"){if(u>=y){b.removeClass("forward").addClass("backward")}else{if(u<y){b.removeClass("backward").addClass("forward")}}}else{if(u>=y){b.removeClass("forward").addClass("backward")}else{if(u<y){b.removeClass("backward").addClass("forward")}}}}function w(){if(i.direction==="horizontal"){if((u>=y&&g===0)||(u<=y&&g===n-1)){return true}}else{if((u>=y&&g===0)||(u<=y&&g===n-1)){return true}}return false}function l(){c.css({"-webkit-animation":"none",display:"none"});e(".current [data-animation]").each(function(E,D){var A=e(D),C=A.attr("data-animation"),F=A.attr("data-duration")||500,B=A.attr("data-timing-function")||"ease",z=A.attr("data-delay")?A.attr("data-delay"):0;if(C==="followSlide"){if(i.direction==="horizontal"&&p==="forward"){C="followSlideToLeft"}else{if(i.direction==="horizontal"&&p==="backward"){C="followSlideToRight"}else{if(i.direction==="vertical"&&p==="forward"){C="followSlideToTop"}else{if(i.direction==="vertical"&&p==="backward"){C="followSlideToBottom"}}}}}A.css({display:"block","-webkit-animation-name":C,"-webkit-animation-duration":F+"ms","-webkit-animation-timing-function":"ease","-webkit-animation-timing-function":B,"-webkit-animation-delay":z+"ms","-webkit-animation-fill-mode":"both"})})}e(document).on("touchstart",".page",function(z){q(z.changedTouches[0])}).on("touchmove",".page",function(z){d(z.changedTouches[0])}).on("touchend",".page",function(z){h(z.changedTouches[0])}).on("webkitAnimationEnd webkitTransitionEnd",".pages",function(){if(p!=="stay"){setTimeout(function(){e(".back").hide().removeClass("back");e(".front").show().removeClass("front");b.removeClass("forward backward animate")},10);e(a.removeClass("current").get(g)).addClass("current");i.onchange(g,a[g],p);l()}});e(".page *").on("webkitAnimationEnd",function(){event.stopPropagation()});e(window).on("load",function(){if(i.progress){e(".parallax-progress").remove();k=false;e(a[g]).addClass("current");i.onchange(g,a[g],p);l()}if(i.indicator){k=false;var A=i.direction==="horizontal"?"parallax-h-indicator":"parallax-v-indicator";e(".wrapper").append("<div class="+A+"></div>");var z="<ul>";for(var B=1;B<=n;B++){if(B===1){z+='<li class="current"></li>'}else{z+="<li></li>"}}z+="</ul>";e("."+A).append(z)}if(i.arrow){a.append('<span class="parallax-arrow"></span>');e(a[n-1]).find(".parallax-arrow").remove()}});window.addEventListener("onorientationchange" in window?"orientationchange":"resize",function(){if(window.orientation===180||window.orientation===0){i.orientationchange("portrait")}if(window.orientation===90||window.orientation===-90){i.orientationchange("landscape")}},false)}(Zepto);